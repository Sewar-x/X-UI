<template>
  <el-button type="primary" @click="openForm1Dialog">æ‰“å¼€ Form1 </el-button>
  <el-button type="primary" @click="openForm2Dialog">æ‰“å¼€ Form2 </el-button>
  <el-button type="primary" @click="openTableDialog">æ‰“å¼€ table </el-button>
</template>

<script setup lang="ts">
import { CreateDialog } from "@/sewen-ui/element-plus";
import { ref, reactive } from "vue";

interface RuleForm1 {
  username: string;
  description: string;
  place: string;
  remarks: string;
  github: string;
  start: boolean;
}
interface RuleForm2 {
  blog: string;
  author: string;
  start: boolean;
}
// å“åº”æ•°æ®
let form1Data = reactive<RuleForm1>({
  username: "sewen-ui",
  description: "an vue2/3 & react componet library",
  place: "huizhou",
  remarks: "Vue React",
  github: "https://github.com/Sewar-x/sewen-ui/",
  start: true,
});

let form2Data = reactive<RuleForm2>({
  blog: "Sewen Blog",
  github: "https://sewar-x.github.io/myblog/",
  projectstart: true,
});
// from1 è¡¨å•é…ç½®é¡¹
const form1Options = {
  mode: form1Data,
  attr: {
    "label-width": "auto",
  },
  items: [
    [
      {
        attr: {
          prop: "username",
          label: "é¡¹ç›®åç§°",
        },
        component: {
          comp: "el-input",
        },
      },
    ],
    [
      {
        attr: {
          prop: "description",
          label: "é¡¹ç›®æè¿°",
        },
        component: {
          comp: "el-input",
          attr: {
            type: "textarea",
          },
        },
      },
    ],
    [
      {
        attr: {
          prop: "place",
          label: "é¡¹ç›®åœ°å€",
        },
        component: {
          comp: "el-select",
          attr: {
            placeholder: "é¡¹ç›®åœ°å€",
          },
          children: [
            {
              comp: "el-option",
              attr: {
                label: "æƒ å·",
                value: "huizhou",
              },
            },
            {
              comp: "el-option",
              attr: {
                label: "å¹¿å·",
                value: "guangzhou",
              },
            },
          ],
        },
      },
    ],
    [
      {
        attr: {
          prop: "remarks",
          label: "æ ‡ç­¾",
        },
        component: {
          comp: "el-input",
        },
      },
    ],
    [
      {
        attr: {
          prop: "github",
          label: "GitHub",
        },
        component: {
          comp: "el-input",
        },
      },
      {
        attr: {
          prop: "start",
          label: "å…³æ³¨",
        },
        component: {
          comp: "el-switch",
        },
      },
      {
        span: 4,
        component: {
          comp: "el-button",
          attr: {
            size: "mini",
          },
          content: {
            text: "æŸ¥çœ‹",
          },
          event: {
            click: function (val: any) {
              window.open(form1Data.github);
            },
          },
        },
      },
    ],
  ],
};

// from2 è¡¨å•é…ç½®é¡¹
const form2Options = {
  mode: form2Data,
  attr: {
    "label-width": "auto",
  },
  items: [
    [
      {
        attr: {
          prop: "blog",
          label: "åšå®¢åç§°",
        },
        component: {
          comp: "el-input",
        },
      },
    ],

    [
      {
        attr: {
          prop: "github",
          label: "GitHub",
        },
        component: {
          comp: "el-input",
        },
      },
    ],
    [
      {
        attr: {
          prop: "start",
          label: "å…³æ³¨",
        },
        component: {
          comp: "el-switch",
        },
      },
    ],
    [
      {
        span: 24,
        component: {
          comp: "el-button",
          attr: {
            size: "mini",
          },
          content: {
            text: "æŸ¥çœ‹",
          },
          event: {
            click: function (val: any) {
              window.open(form2Data.github);
            },
          },
        },
      },
    ],
  ],
};

// è¡¨æ ¼æ•°æ®
const tableData = [
  {
    date: "2016-05-02",
    name: "ç‹å°è™",
    address: "ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1518 å¼„",
    select: "é€è´§ä¸Šé—¨",
  },
  {
    date: "2016-05-04",
    name: "ç‹å°è™",
    address: "ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1517 å¼„",
    select: "è‡ªå–",
  },
  {
    date: "2016-05-01",
    name: "ç‹å°è™",
    address: "ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1519 å¼„",
    select: "è‡ªå–",
  },
  {
    date: "2016-05-03",
    name: "ç‹å°è™",
    address: "ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1516 å¼„",
    select: "è‡ªå–",
  },
];
// è¡¨æ ¼åˆ—é…ç½®
const columns = [
  {
    attr: {
      prop: "date",
      label: "æ—¥æœŸ",
    },
  },
  {
    attr: {
      prop: "name",
      label: "å§“å",
    },
  },
  {
    attr: {
      prop: "address",
      label: "åœ°å€",
    },
    defaultSlot: {
      comp: "el-input",
    },
  },
  {
    attr: {
      prop: "select",
      label: "é…é€æ–¹å¼",
    },
    defaultSlot: {
      comp: "el-select",
      attr: {
        placeholder: "Select",
        size: "default",
      },
      children: ["é€è´§ä¸Šé—¨", "è‡ªå–"].map((option) => {
        return {
          comp: "el-option",
          attr: {
            key: option,
            label: option,
            value: option,
          },
        };
      }),
      event: {
        change: function (currentRowData: any, val: any) {
          console.log(`ğŸš€ ~ æ‚¨é€‰ä¸­çš„è¡Œæ•°æ®æ˜¯ ${currentRowData}, é€‰ä¸­çš„å€¼æ˜¯ ${val}`);
        },
      },
    },
  },
  {
    attr: {
      prop: "",
      label: "æ“ä½œ",
      width: "150",
    },
    defaultSlot: [
      {
        comp: "el-button",
        attr: {
          type: "primary",
          size: "small",
        },
        content: {
          text: "æäº¤",
        },
        event: {
          click: function (currentRowData: any) {
            alert(`ğŸš€ ~ æ‚¨æäº¤çš„è¡Œæ•°æ®æ˜¯ ${currentRowData}`);
          },
        },
      },
      {
        comp: "el-button",
        attr: {
          type: "danger",
          size: "small",
        },
        content: {
          text: "åˆ é™¤",
        },
        event: {
          click: function (currentRowData: any) {
            alert(`ğŸš€ ~ æ‚¨åˆ é™¤çš„è¡Œæ•°æ®æ˜¯  ${currentRowData}`);
          },
        },
      },
    ],
  },
];
// è¡¨æ ¼é…ç½®
const tableOptions = {
  data: tableData,
  pagination: false, //ä¸ä½¿ç”¨åˆ†é¡µæ¨¡å¼ï¼Œéœ€è¦æ˜¾ç¤ºé…ç½® false (é»˜è®¤ä½¿ç”¨åˆ†é¡µæ¨¡å¼)
  columns: columns,
};

const dialogOptions = {
  id: "test-dialog",
  visible: ref(false),
  attr: {
    title: "å†…å®¹åŠ¨æ€å¼¹çª—",
    draggable: true,
    "close-on-click-modal": false,
  },
  content: [],
};

// åˆ›å»ºå¼¹çª—
const dialogInst = CreateDialog(dialogOptions);
// æ‰“å¼€ form1 å¼¹çª—å†…å®¹
const openForm1Dialog = () => {
  // é‡ç½®å¼¹çª—å†…å®¹
  dialogInst?.resetContent([
    {
      type: "Form",
      options: form1Options,
    },
  ]);
  dialogInst?.show();
};

const openForm2Dialog = () => {
  // é‡ç½®å¼¹çª—å†…å®¹
  dialogInst?.resetContent([
    {
      type: "Form",
      options: form2Options,
    },
  ]);
  dialogInst?.show();
};

const openTableDialog = () => {
  // é‡ç½®å¼¹çª—å†…å®¹
  dialogInst?.resetContent([
    {
      type: "Table",
      options: tableOptions,
    },
  ]);
  dialogInst?.show();
};
</script>

<style scoped lang="less"></style>
